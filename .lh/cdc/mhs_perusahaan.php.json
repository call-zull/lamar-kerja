{
    "sourceFile": "cdc/mhs_perusahaan.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1721781476431,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1721783600967,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,9 +7,9 @@\n \r\n // Include database connection file\r\n include '../includes/db.php';\r\n \r\n-// Fetch detailed student data and their accepted job positions\r\n+\r\n function fetchStudentsAndJobs($pdo) {\r\n     try {\r\n         $sql = \"SELECT m.id, m.nim, m.nama_mahasiswa, j.nama_jurusan AS jurusan, p.nama_prodi AS prodi, m.status, m.tahun_masuk, \r\n                        lm.status AS lamaran_status, l.nama_pekerjaan, pr.nama_perusahaan, lm.salary\r\n@@ -137,10 +137,10 @@\n                                                 </tr>\r\n                                             </thead>\r\n                                             <tbody>\r\n                                                 <?php foreach ($students_and_jobs as $index => $student): ?>\r\n-                                                    <tr>\r\n-                                                        <td><?= $index + 1 ?></td>\r\n+                                                <tr>\r\n+                                                    <td><?= $index + 1 ?></td>\r\n                                                     <td><?= htmlspecialchars($student['nim']) ?></td>\r\n                                                     <td><?= htmlspecialchars($student['nama_mahasiswa']) ?></td>\r\n                                                     <td><?= htmlspecialchars($student['jurusan']) ?></td>\r\n                                                     <td><?= htmlspecialchars($student['prodi']) ?></td>\r\n@@ -151,23 +151,23 @@\n                                                     <td><?= htmlspecialchars($student['nama_perusahaan'] ?? 'N/A') ?>\r\n                                                     </td>\r\n                                                     <td>\r\n                                                         <?php if (strtolower($student['lamaran_status']) === 'diterima'): ?>\r\n-                                                            <span class=\"badge badge-success\">Diterima</span>\r\n+                                                        <span class=\"badge badge-success\">Diterima</span>\r\n                                                         <?php elseif (strtolower($student['lamaran_status']) === 'ditolak'): ?>\r\n-                                                            <span class=\"badge badge-danger\">Ditolak</span>\r\n+                                                        <span class=\"badge badge-danger\">Ditolak</span>\r\n                                                         <?php else: ?>\r\n-                                                            <span class=\"badge badge-secondary\">Belum ada status</span>\r\n+                                                        <span class=\"badge badge-secondary\">Belum ada status</span>\r\n                                                         <?php endif; ?>\r\n                                                     </td>\r\n                                                     <td><?= htmlspecialchars($student['salary'] ?? 'N/A') ?></td>\r\n                                                     <td>\r\n                                                         <button type=\"button\" class=\"btn btn-secondary btn-sm\"\r\n                                                             onclick=\"cetakPDF(<?= $student['id'] ?>)\">\r\n                                                             <i class=\"fas fa-print\"></i> Cetak\r\n                                                         </button>\r\n-                                                        </td>\r\n-                                                        </tr>\r\n+                                                    </td>\r\n+                                                </tr>\r\n                                                 <?php endforeach; ?>\r\n                                             </tbody>\r\n                                         </table>\r\n                                     </div>\r\n"
                }
            ],
            "date": 1721781476431,
            "name": "Commit-0",
            "content": "<?php\r\nsession_start();\r\nif (!isset($_SESSION['user_id']) || ($_SESSION['role'] !== 'cdc')) {\r\n    header('Location: ../../auth/login.php');\r\n    exit;\r\n}\r\n\r\n// Include database connection file\r\ninclude '../includes/db.php';\r\n\r\n// Fetch detailed student data and their accepted job positions\r\nfunction fetchStudentsAndJobs($pdo) {\r\n    try {\r\n        $sql = \"SELECT m.id, m.nim, m.nama_mahasiswa, j.nama_jurusan AS jurusan, p.nama_prodi AS prodi, m.status, m.tahun_masuk, \r\n                       lm.status AS lamaran_status, l.nama_pekerjaan, pr.nama_perusahaan, lm.salary\r\n                FROM mahasiswas m\r\n                JOIN prodis p ON m.prodi_id = p.id\r\n                JOIN jurusans j ON m.jurusan_id = j.id\r\n                LEFT JOIN lamaran_mahasiswas lm ON m.id = lm.mahasiswa_id\r\n                LEFT JOIN lowongan_kerja l ON lm.lowongan_id = l.id\r\n                LEFT JOIN perusahaans pr ON l.perusahaan_id = pr.id\";\r\n        $stmt = $pdo->query($sql);\r\n        return $stmt->fetchAll(PDO::FETCH_ASSOC);\r\n    } catch (PDOException $e) {\r\n        echo \"Error fetching student and job data: \" . $e->getMessage();\r\n        return false;\r\n    }\r\n}\r\n\r\n$students_and_jobs = fetchStudentsAndJobs($pdo);\r\n?>\r\n\r\n<!DOCTYPE html>\r\n<html lang=\"en\">\r\n\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n    <title>Data Mahasiswa dan Pekerjaan</title>\r\n    <link rel=\"stylesheet\" href=\"../assets/bootstrap/css/bootstrap.min.css\">\r\n    <link rel=\"stylesheet\" href=\"../app/plugins/fontawesome-free/css/all.min.css\">\r\n    <link rel=\"stylesheet\" href=\"../app/dist/css/adminlte.min.css\">\r\n    <link rel=\"stylesheet\" href=\"../app/dist/css/adminlte.dark.min.css\" media=\"screen\">\r\n    <link rel=\"stylesheet\" href=\"../app/dist/css/adminlte.light.min.css\" media=\"screen\">\r\n    <link rel=\"stylesheet\" href=\"../app/plugins/datatables-bs4/css/dataTables.bootstrap4.min.css\">\r\n    <link rel=\"stylesheet\" href=\"../app/plugins/datatables-responsive/css/responsive.bootstrap4.min.css\">\r\n    <style>\r\n    .nav-sidebar .nav-link.active {\r\n        background-color: #343a40 !important;\r\n    }\r\n\r\n    .content-wrapper {\r\n        padding: 20px !important;\r\n    }\r\n\r\n    .content-header {\r\n        padding: 20px 0 !important;\r\n    }\r\n\r\n    .table-responsive {\r\n        display: block;\r\n        width: 100%;\r\n        overflow-x: auto;\r\n        -webkit-overflow-scrolling: touch;\r\n    }\r\n    </style>\r\n</head>\r\n\r\n<body class=\"hold-transition sidebar-mini layout-fixed layout-navbar-fixed layout-footer-fixed\">\r\n    <div class=\"wrapper\">\r\n        <!-- Navbar inclusion -->\r\n        <?php include 'navbar_cdc.php'; ?>\r\n\r\n        <div class=\"content-wrapper\">\r\n            <div class=\"content-header\">\r\n                <div class=\"row mb-2\">\r\n                    <div class=\"col-sm-6\">\r\n                        <h4 class=\"m-0\">Data Mahasiswa dan Pekerjaan</h4>\r\n                    </div>\r\n                    <div class=\"col-sm-6\">\r\n                        <ol class=\"breadcrumb float-sm-right\">\r\n                            <li class=\"breadcrumb-item\"><a href=\"../index.php\">Home</a></li>\r\n                            <li class=\"breadcrumb-item active\">Data Mahasiswa dan Pekerjaan</li>\r\n                        </ol>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <!-- Main content -->\r\n            <section class=\"content\">\r\n                <div class=\"container-fluid\">\r\n                    <div class=\"row\">\r\n                        <section class=\"col-lg-12 connectedSortable\">\r\n                            <div class=\"card\">\r\n                                <div class=\"card-header\">\r\n                                    <h3 class=\"card-title\">\r\n                                        <i class=\"fas fa-trophy\"></i>\r\n                                        Data Mahasiswa dan Pekerjaan\r\n                                    </h3>\r\n                                    <div class=\"card-tools\">\r\n                                        <div class=\"input-group input-group-sm\">\r\n                                            <select id=\"statusFilter\" class=\"form-control\">\r\n                                                <option value=\"\">Semua Status</option>\r\n                                                <option value=\"diterima\">Diterima</option>\r\n                                                <option value=\"ditolak\">Ditolak</option>\r\n                                            </select>\r\n                                            <select id=\"prodiFilter\" class=\"form-control\">\r\n                                                <option value=\"\">Semua Prodi</option>\r\n                                                <?php\r\n                                                $sql = \"SELECT id, nama_prodi FROM prodis\";\r\n                                                $stmt = $pdo->query($sql);\r\n                                                while ($prodi = $stmt->fetch(PDO::FETCH_ASSOC)) {\r\n                                                    echo \"<option value='{$prodi['nama_prodi']}'>{$prodi['nama_prodi']}</option>\";\r\n                                                }\r\n                                                ?>\r\n                                            </select>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div class=\"card-body\">\r\n                                    <div class=\"table-responsive\">\r\n                                        <table id=\"mahasiswaTable\" class=\"table table-bordered table-striped\">\r\n                                            <thead>\r\n                                                <tr>\r\n                                                    <th>No</th>\r\n                                                    <th>NIM</th>\r\n                                                    <th>Nama Mahasiswa</th>\r\n                                                    <th>Jurusan</th>\r\n                                                    <th>Prodi</th>\r\n                                                    <th>Status</th>\r\n                                                    <th>Tahun Masuk</th>\r\n                                                    <th>Nama Lowongan</th>\r\n                                                    <th>Nama Perusahaan</th>\r\n                                                    <th>Status Lamaran</th>\r\n                                                    <th>Gaji</th>\r\n                                                    <th>Aksi</th>\r\n                                                </tr>\r\n                                            </thead>\r\n                                            <tbody>\r\n                                                <?php foreach ($students_and_jobs as $index => $student): ?>\r\n                                                <tr>\r\n                                                    <td><?= $index + 1 ?></td>\r\n                                                    <td><?= htmlspecialchars($student['nim']) ?></td>\r\n                                                    <td><?= htmlspecialchars($student['nama_mahasiswa']) ?></td>\r\n                                                    <td><?= htmlspecialchars($student['jurusan']) ?></td>\r\n                                                    <td><?= htmlspecialchars($student['prodi']) ?></td>\r\n                                                    <td><?= htmlspecialchars($student['status']) ?></td>\r\n                                                    <td><?= htmlspecialchars($student['tahun_masuk']) ?></td>\r\n                                                    <td><?= htmlspecialchars($student['nama_pekerjaan'] ?? 'N/A') ?>\r\n                                                    </td>\r\n                                                    <td><?= htmlspecialchars($student['nama_perusahaan'] ?? 'N/A') ?>\r\n                                                    </td>\r\n                                                    <td>\r\n                                                        <?php if (strtolower($student['lamaran_status']) === 'diterima'): ?>\r\n                                                        <span class=\"badge badge-success\">Diterima</span>\r\n                                                        <?php elseif (strtolower($student['lamaran_status']) === 'ditolak'): ?>\r\n                                                        <span class=\"badge badge-danger\">Ditolak</span>\r\n                                                        <?php else: ?>\r\n                                                        <span class=\"badge badge-secondary\">Belum ada status</span>\r\n                                                        <?php endif; ?>\r\n                                                    </td>\r\n                                                    <td><?= htmlspecialchars($student['salary'] ?? 'N/A') ?></td>\r\n                                                    <td>\r\n                                                        <button type=\"button\" class=\"btn btn-secondary btn-sm\"\r\n                                                            onclick=\"cetakPDF(<?= $student['id'] ?>)\">\r\n                                                            <i class=\"fas fa-print\"></i> Cetak\r\n                                                        </button>\r\n                                                    </td>\r\n                                                </tr>\r\n                                                <?php endforeach; ?>\r\n                                            </tbody>\r\n                                        </table>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </section>\r\n                    </div>\r\n                </div>\r\n            </section>\r\n        </div>\r\n    </div>\r\n\r\n    <!-- Scripts -->\r\n    <script src=\"../app/plugins/jquery/jquery.min.js\"></script>\r\n    <script src=\"../app/plugins/bootstrap/js/bootstrap.bundle.min.js\"></script>\r\n    <script src=\"../app/plugins/datatables/jquery.dataTables.min.js\"></script>\r\n    <script src=\"../app/plugins/datatables-bs4/js/dataTables.bootstrap4.min.js\"></script>\r\n    <script src=\"../app/plugins/datatables-responsive/js/dataTables.responsive.min.js\"></script>\r\n    <script src=\"../app/plugins/datatables-responsive/js/responsive.bootstrap4.min.js\"></script>\r\n    <script src=\"../app/dist/js/adminlte.min.js\"></script>\r\n    <script>\r\n    $(document).ready(function() {\r\n        var table = $('#mahasiswaTable').DataTable();\r\n\r\n        $('#statusFilter').on('change', function() {\r\n            var status = $(this).val();\r\n            table.column(9).search(status).draw();\r\n        });\r\n\r\n        $('#prodiFilter').on('change', function() {\r\n            var prodi = $(this).val();\r\n            table.column(4).search(prodi).draw();\r\n        });\r\n    });\r\n\r\n    function cetakPDF(mahasiswaId) {\r\n        window.location.href = 'cetak_pdf.php?id=' + mahasiswaId;\r\n    }\r\n    </script>\r\n</body>\r\n\r\n</html>"
        }
    ]
}